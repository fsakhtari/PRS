running
  '/ddn/gs1/home/akhtarifs/R-4.0.1/bin/R --no-echo --no-restore --file=../../common/scripts/test_prs.R'


  The 'cran_repo' argument in shelf() was not set, so it will use
  cran_repo = 'https://cran.r-project.org' by default.

  To avoid this message, set the 'cran_repo' argument to a CRAN
  mirror URL (see https://cran.r-project.org/mirrors.html) or set
  'quiet = TRUE'.
Warning: replacing previous import ‘vctrs::data_frame’ by ‘tibble::data_frame’ when loading ‘dplyr’
[1] "num cores available =  96"
[1] "using 86 cores"
[1] "Command-line options:"
$validn_geno
[1] "../derived_data/validation_data/ukb_geno.rds"

$validn_pheno
[1] "../derived_data/validation_data/ukb_pheno.rds"

$test_geno
[1] "../derived_data/test_data/epr_geno.rds"

$test_pheno
[1] "../derived_data/test_data/epr_pheno.rds"

$help
[1] FALSE

[1] "Validation genotype data:"
List of 3
 $ genotypes:Reference class 'FBM.code256' [package "bigstatsr"] with 15 fields
  ..and 26 methods, of which 12 are  possibly relevant:
  ..  add_columns, as.FBM, bm, bm.desc, check_dimensions,
  ..  check_write_permissions, copy#envRefClass, initialize, initialize#FBM,
  ..  save, show#envRefClass, show#FBM
 $ fam      :'data.frame':	440757 obs. of  6 variables:
  ..$ family.ID  : int [1:440757] 1000014 1000023 1000030 1000041 1000059 1000..
  ..$ sample.ID  : int [1:440757] 1000014 1000023 1000030 1000041 1000059 1000..
  ..$ paternal.ID: int [1:440757] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ maternal.ID: int [1:440757] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ sex        : int [1:440757] 2 1 1 1 2 2 1 2 1 1 ...
  ..$ affection  : int [1:440757] -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 ...
 $ map      :'data.frame':	443200 obs. of  6 variables:
  ..$ chromosome  : int [1:443200] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ marker.ID   : chr [1:443200] "rs79373928" "rs4970383" "rs4970382" "rs95"..
  ..$ genetic.dist: int [1:443200] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ physical.pos: int [1:443200] 801536 838555 840753 846864 849998 850780 8..
  ..$ allele1     : chr [1:443200] "G" "A" "C" "C" ...
  ..$ allele2     : chr [1:443200] "T" "C" "T" "G" ...
 - attr(*, "class")= chr "bigSNP"
[1] "Validation survey data:"
Classes ‘data.table’ and 'data.frame':	440757 obs. of  16 variables:
 $ f.eid    : int  1000014 1000023 1000030 1000041 1000059 1000062 1000077 1000086 1000095 1000100 ...
 $ Y        : Factor w/ 2 levels "0","1": 1 1 1 1 2 1 1 1 1 1 ...
 $ age      : num  69 60 59 55 64 54 53 69 44 69 ...
 $ sex      : Factor w/ 2 levels "0","1": 1 2 2 2 1 1 2 1 2 2 ...
 $ ethnicity: Factor w/ 6 levels "1","2","3","4",..: 1 6 1 1 4 1 1 1 2 1 ...
 $ bmi      : num  29.1 29.6 25.3 29.9 41.7 ...
 $ PC1      : num  -15.2244 19.2127 0.0657 -15.7492 351.468 ...
 $ PC2      : num  6.66 -10.1 -2.29 3.88 70.09 ...
 $ PC3      : num  -5.57 24.43 6.96 -2.7 -6 ...
 $ PC4      : num  0.125 -80.869 -20.936 2.32 4.601 ...
 $ PC5      : num  8.25 11.91 -5.1 1.81 1.42 ...
 $ PC6      : num  -4.348 -10.567 5.065 -1.5 0.383 ...
 $ PC7      : num  -0.8444 -23.7286 -14.4456 -2.2846 0.0965 ...
 $ PC8      : num  1.13 -13.48 5.51 -2.21 -1.08 ...
 $ PC9      : num  2.633 0.136 -0.789 -6.59 -1.11 ...
 $ PC10     : num  -2.743 3.489 -1.562 2.109 -0.904 ...
 - attr(*, ".internal.selfref")=<externalptr> 
[1] "Test genotype data:"
List of 3
 $ genotypes:Reference class 'FBM.code256' [package "bigstatsr"] with 15 fields
  ..and 26 methods, of which 12 are  possibly relevant:
  ..  add_columns, as.FBM, bm, bm.desc, check_dimensions,
  ..  check_write_permissions, copy#envRefClass, initialize, initialize#FBM,
  ..  save, show#envRefClass, show#FBM
 $ fam      :'data.frame':	4201 obs. of  6 variables:
  ..$ family.ID  : chr [1:4201] "SM-IXVUB" "SM-IXVUC" "SM-IXVUD" "SM-IXVUE" ...
  ..$ sample.ID  : chr [1:4201] "SM-IXVUB" "SM-IXVUC" "SM-IXVUD" "SM-IXVUE" ...
  ..$ paternal.ID: int [1:4201] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ maternal.ID: int [1:4201] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ sex        : int [1:4201] 2 2 2 1 1 1 1 2 2 2 ...
  ..$ affection  : int [1:4201] -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 ...
 $ map      :'data.frame':	9585184 obs. of  6 variables:
  ..$ chromosome  : int [1:9585184] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ marker.ID   : chr [1:9585184] "1:13668" "rs201055865" "1:14773" "1:1484"..
  ..$ genetic.dist: int [1:9585184] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ physical.pos: int [1:9585184] 13668 14671 14773 14843 14948 15112 15352 ..
  ..$ allele1     : chr [1:9585184] "A" "C" "T" "A" ...
  ..$ allele2     : chr [1:9585184] "G" "G" "C" "G" ...
 - attr(*, "class")= chr "bigSNP"
[1] "Test survey data:"
'data.frame':	4201 obs. of  47 variables:
 $ epr_number    : num  4 9 10 11 28 40 41 43 45 48 ...
 $ Sample_ID     : chr  "SM-JJFY5" "SM-JJFY6" "SM-JJFY7" "SM-JKH2X" ...
 $ Y             : Factor w/ 2 levels "0","1": 1 1 2 1 1 1 1 1 1 1 ...
 $ PC1           : num  0.00707 0.00699 -0.02971 0.00686 0.00647 ...
 $ PC2           : num  -0.00371 -0.0036 -0.00117 -0.00342 -0.00337 ...
 $ PC3           : num  -0.00236 -0.00182 -0.00355 -0.00195 -0.00128 ...
 $ PC4           : num  4.51e-05 -1.11e-05 -3.78e-03 6.23e-05 -2.52e-04 ...
 $ PC5           : num  -0.00607 -0.00416 0.00145 -0.00555 -0.00551 ...
 $ PC6           : num  -1.62e-05 7.78e-05 8.40e-04 -1.73e-05 1.47e-04 ...
 $ PC7           : num  -1.49e-04 -8.46e-04 -2.09e-02 -2.41e-05 -7.14e-04 ...
 $ PC8           : num  1.29e-04 1.62e-05 -1.46e-02 2.03e-04 -1.72e-04 ...
 $ PC9           : num  0.000133 -0.000232 0.031994 -0.000224 -0.000214 ...
 $ PC10          : num  5.20e-05 3.85e-05 2.43e-02 -2.24e-04 1.24e-04 ...
 $ PC11          : num  -0.00025 -0.00045 -0.003456 -0.000115 -0.000232 ...
 $ PC12          : num  1.72e-04 2.07e-04 9.25e-03 3.64e-05 7.58e-05 ...
 $ PC13          : num  -4.22e-05 -2.08e-04 2.97e-02 2.12e-04 4.05e-04 ...
 $ PC14          : num  -9.15e-05 1.76e-04 -8.15e-03 -1.27e-06 1.55e-04 ...
 $ PC15          : num  5.45e-05 -2.29e-04 2.82e-02 -2.14e-06 -2.19e-04 ...
 $ PC16          : num  -1.24e-05 -7.77e-05 -1.60e-03 7.20e-05 -1.89e-04 ...
 $ PC17          : num  -1.79e-04 4.06e-05 -3.39e-03 -3.72e-05 -4.94e-04 ...
 $ PC18          : num  -3.19e-06 9.60e-05 -1.23e-02 -3.26e-04 5.45e-04 ...
 $ PC19          : num  -7.09e-05 2.51e-04 1.83e-02 -1.12e-04 2.21e-04 ...
 $ PC20          : num  0.000162 0.00021 0.013969 0.000162 -0.000464 ...
 $ PC21          : num  -2.75e-05 -8.27e-05 7.70e-03 2.30e-04 3.20e-04 ...
 $ PC22          : num  -1.32e-04 -6.88e-05 -2.78e-03 -3.64e-05 9.78e-05 ...
 $ PC23          : num  -1.23e-04 2.85e-04 1.91e-02 1.09e-04 -2.07e-05 ...
 $ PC24          : num  -2.28e-04 9.71e-05 4.36e-02 -1.13e-04 1.99e-04 ...
 $ PC25          : num  1.47e-04 -6.22e-05 -3.50e-02 5.55e-05 -1.90e-04 ...
 $ PC26          : num  -4.41e-05 9.53e-05 -7.05e-03 -2.35e-05 2.64e-04 ...
 $ PC27          : num  -1.02e-04 2.01e-04 -2.62e-02 -1.38e-04 -4.06e-05 ...
 $ PC28          : num  -2.84e-05 9.93e-05 5.50e-03 2.15e-04 -4.31e-05 ...
 $ PC29          : num  -4.35e-05 9.55e-05 3.41e-03 1.29e-04 1.01e-05 ...
 $ PC30          : num  -0.000033 -0.000186 -0.001558 0.000106 0.000159 ...
 $ PC31          : num  3.67e-04 -1.44e-04 1.87e-03 -3.79e-06 -9.39e-05 ...
 $ PC32          : num  2.72e-05 2.57e-04 -2.10e-02 -7.68e-05 -1.36e-04 ...
 $ PC33          : num  2.26e-04 3.03e-05 -2.26e-02 3.88e-05 -3.69e-04 ...
 $ PC34          : num  2.73e-05 -1.86e-04 1.11e-02 4.34e-04 1.75e-04 ...
 $ PC35          : num  6.39e-05 6.53e-05 -2.15e-02 -9.55e-05 1.37e-05 ...
 $ PC36          : num  -1.36e-04 5.92e-05 -2.93e-03 6.75e-05 3.78e-05 ...
 $ PC37          : num  -2.31e-04 1.58e-04 5.41e-02 6.27e-05 -9.00e-05 ...
 $ PC38          : num  -2.67e-04 2.00e-04 2.00e-02 -3.86e-05 -3.40e-04 ...
 $ PC39          : num  2.40e-04 2.14e-04 7.62e-03 7.82e-05 -5.24e-06 ...
 $ PC40          : num  -0.000299 0.000145 0.001794 -0.000441 0.000412 ...
 $ age_derived   : num  66 49 72 70 48 102 61 60 70 64 ...
 $ gender        : Factor w/ 2 levels "0","1": 2 2 2 1 1 2 2 2 2 2 ...
 $ race          : Factor w/ 6 levels "1","2","3","4",..: 5 5 3 5 5 5 5 5 5 5 ...
 $ he_bmi_derived: num  29.1 42 38.6 30.5 24 23.8 24.5 25.7 21.1 19 ...
Total number of SNPs input to LDpred =  122359 
Proportion of SNPs used in PRS computation (i.e. SNPs with non-zero beta
  values) = 0.8423492 

==Computing and testing total PRS for validn dataset from the following files ==
 [1] "../output/validn_prs_chr1.txt"  "../output/validn_prs_chr10.txt"
 [3] "../output/validn_prs_chr11.txt" "../output/validn_prs_chr12.txt"
 [5] "../output/validn_prs_chr13.txt" "../output/validn_prs_chr14.txt"
 [7] "../output/validn_prs_chr15.txt" "../output/validn_prs_chr16.txt"
 [9] "../output/validn_prs_chr17.txt" "../output/validn_prs_chr18.txt"
[11] "../output/validn_prs_chr19.txt" "../output/validn_prs_chr2.txt" 
[13] "../output/validn_prs_chr20.txt" "../output/validn_prs_chr21.txt"
[15] "../output/validn_prs_chr22.txt" "../output/validn_prs_chr3.txt" 
[17] "../output/validn_prs_chr4.txt"  "../output/validn_prs_chr5.txt" 
[19] "../output/validn_prs_chr6.txt"  "../output/validn_prs_chr7.txt" 
[21] "../output/validn_prs_chr8.txt"  "../output/validn_prs_chr9.txt" 
PRS dataframe for validn dataset:
Classes ‘data.table’ and 'data.frame':	440757 obs. of  17 variables:
 $ f.eid    : int  1000014 1000023 1000030 1000041 1000059 1000062 1000077 1000086 1000095 1000100 ...
 $ Y        : Factor w/ 2 levels "0","1": 1 1 1 1 2 1 1 1 1 1 ...
 $ age      : num  69 60 59 55 64 54 53 69 44 69 ...
 $ sex      : Factor w/ 2 levels "0","1": 1 2 2 2 1 1 2 1 2 2 ...
 $ ethnicity: Factor w/ 6 levels "1","2","3","4",..: 1 6 1 1 4 1 1 1 2 1 ...
 $ bmi      : num  29.1 29.6 25.3 29.9 41.7 ...
 $ PC1      : num  -15.2244 19.2127 0.0657 -15.7492 351.468 ...
 $ PC2      : num  6.66 -10.1 -2.29 3.88 70.09 ...
 $ PC3      : num  -5.57 24.43 6.96 -2.7 -6 ...
 $ PC4      : num  0.125 -80.869 -20.936 2.32 4.601 ...
 $ PC5      : num  8.25 11.91 -5.1 1.81 1.42 ...
 $ PC6      : num  -4.348 -10.567 5.065 -1.5 0.383 ...
 $ PC7      : num  -0.8444 -23.7286 -14.4456 -2.2846 0.0965 ...
 $ PC8      : num  1.13 -13.48 5.51 -2.21 -1.08 ...
 $ PC9      : num  2.633 0.136 -0.789 -6.59 -1.11 ...
 $ PC10     : num  -2.743 3.489 -1.562 2.109 -0.904 ...
 $ PRS      : num  0.463 0.14 0.682 0.218 0.604 ...
 - attr(*, ".internal.selfref")=<externalptr> 
 - attr(*, "sorted")= chr "f.eid"
[1] "In function do_glm() :"
[1] "data frame for glm model:"
Classes ‘data.table’ and 'data.frame':	440757 obs. of  15 variables:
 $ Y   : Factor w/ 2 levels "0","1": 1 1 1 1 2 1 1 1 1 1 ...
 $ age : num  69 60 59 55 64 54 53 69 44 69 ...
 $ sex : Factor w/ 2 levels "0","1": 1 2 2 2 1 1 2 1 2 2 ...
 $ bmi : num  29.1 29.6 25.3 29.9 41.7 ...
 $ PC1 : num  -15.2244 19.2127 0.0657 -15.7492 351.468 ...
 $ PC2 : num  6.66 -10.1 -2.29 3.88 70.09 ...
 $ PC3 : num  -5.57 24.43 6.96 -2.7 -6 ...
 $ PC4 : num  0.125 -80.869 -20.936 2.32 4.601 ...
 $ PC5 : num  8.25 11.91 -5.1 1.81 1.42 ...
 $ PC6 : num  -4.348 -10.567 5.065 -1.5 0.383 ...
 $ PC7 : num  -0.8444 -23.7286 -14.4456 -2.2846 0.0965 ...
 $ PC8 : num  1.13 -13.48 5.51 -2.21 -1.08 ...
 $ PC9 : num  2.633 0.136 -0.789 -6.59 -1.11 ...
 $ PC10: num  -2.743 3.489 -1.562 2.109 -0.904 ...
 $ PRS : num  0.463 0.14 0.682 0.218 0.604 ...
 - attr(*, ".internal.selfref")=<externalptr> 
NULL
[1] "Fitting GLM model:"
Y ~ age + sex + bmi + PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + 
    PC8 + PC9 + PC10 + PRS
<environment: 0x119c61d8>
[1] "GLM model summary:"

Call:
glm(formula = glm_formula, family = "binomial", data = glm_df, 
    singular.ok = FALSE)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.0693  -0.3429  -0.2278  -0.1458   3.7479  

Coefficients:
              Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -1.316e+01  7.924e-02 -166.082  < 2e-16 ***
age          7.678e-02  1.016e-03   75.563  < 2e-16 ***
sex1         7.390e-01  1.450e-02   50.984  < 2e-16 ***
bmi          1.749e-01  1.270e-03  137.693  < 2e-16 ***
PC1          2.375e-03  1.052e-04   22.583  < 2e-16 ***
PC2         -6.190e-03  2.096e-04  -29.535  < 2e-16 ***
PC3          7.893e-03  3.735e-04   21.132  < 2e-16 ***
PC4          6.963e-03  6.338e-04   10.986  < 2e-16 ***
PC5          3.021e-04  9.516e-04    0.317 0.750894    
PC6         -2.471e-03  1.407e-03   -1.756 0.079092 .  
PC7          5.338e-03  1.412e-03    3.781 0.000156 ***
PC8         -1.919e-03  1.514e-03   -1.267 0.204978    
PC9          3.416e-03  1.588e-03    2.151 0.031484 *  
PC10         4.588e-03  1.345e-03    3.411 0.000648 ***
PRS          1.177e+00  2.291e-02   51.383  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 188697  on 440756  degrees of freedom
Residual deviance: 156586  on 440742  degrees of freedom
AIC: 156616

Number of Fisher Scoring iterations: 6

Setting levels: control = 0, case = 1
Setting direction: controls < cases
GLM output for validn dataset:
  estimate  std_error   zvalue pvalue     auc
1 1.177332 0.02291284 51.38309      0 0.81523
[1] "Calculating pseudo-R2:"
[1] "Full model (with PRS):"
Logistic Regression Model
 
 lrm(formula = Y ~ ., data = glm_df)
 
                          Model Likelihood    Discrimination    Rank Discrim.    
                                Ratio Test           Indexes          Indexes    
 Obs         440757    LR chi2    32111.16    R2       0.202    C       0.815    
  0          416348    d.f.             14    g        1.385    Dxy     0.630    
  1           24409    Pr(> chi2)  <0.0001    gr       3.995    gamma   0.631    
 max |deriv|  6e-10                           gp       0.063    tau-a   0.066    
                                              Brier    0.047                     
 
           Coef     S.E.   Wald Z  Pr(>|Z|)
 Intercept -13.1610 0.0793 -166.06 <0.0001 
 age         0.0768 0.0010   75.56 <0.0001 
 sex=1       0.7390 0.0145   50.98 <0.0001 
 bmi         0.1749 0.0013  137.68 <0.0001 
 PC1         0.0024 0.0001   22.58 <0.0001 
 PC2        -0.0062 0.0002  -29.53 <0.0001 
 PC3         0.0079 0.0004   21.13 <0.0001 
 PC4         0.0070 0.0006   10.99 <0.0001 
 PC5         0.0003 0.0010    0.32 0.7509  
 PC6        -0.0025 0.0014   -1.76 0.0791  
 PC7         0.0053 0.0014    3.78 0.0002  
 PC8        -0.0019 0.0015   -1.27 0.2050  
 PC9         0.0034 0.0016    2.15 0.0315  
 PC10        0.0046 0.0013    3.41 0.0006  
 PRS         1.1773 0.0229   51.38 <0.0001 
 
[1] "Reduced model (without PRS):"
Logistic Regression Model
 
 lrm(formula = Y ~ ., data = glm_df %>% select(-PRS))
 
                          Model Likelihood    Discrimination    Rank Discrim.    
                                Ratio Test           Indexes          Indexes    
 Obs         440757    LR chi2    29438.98    R2       0.186    C       0.804    
  0          416348    d.f.             13    g        1.301    Dxy     0.608    
  1           24409    Pr(> chi2)  <0.0001    gr       3.672    gamma   0.608    
 max |deriv|  5e-10                           gp       0.061    tau-a   0.064    
                                              Brier    0.048                     
 
           Coef     S.E.   Wald Z  Pr(>|Z|)
 Intercept -12.7238 0.0777 -163.68 <0.0001 
 age         0.0757 0.0010   75.02 <0.0001 
 sex=1       0.7280 0.0144   50.51 <0.0001 
 bmi         0.1723 0.0013  137.32 <0.0001 
 PC1         0.0036 0.0001   35.62 <0.0001 
 PC2        -0.0068 0.0002  -32.60 <0.0001 
 PC3         0.0096 0.0004   25.99 <0.0001 
 PC4         0.0024 0.0006    3.91 <0.0001 
 PC5        -0.0015 0.0009   -1.62 0.1057  
 PC6        -0.0021 0.0014   -1.49 0.1350  
 PC7         0.0060 0.0014    4.32 <0.0001 
 PC8        -0.0014 0.0015   -0.91 0.3624  
 PC9         0.0027 0.0016    1.73 0.0829  
 PC10        0.0044 0.0013    3.32 0.0009  
 
Proportion of variance explained by PRS using Nagelkerke’s pseudo-R2 metric = 0.01623418 
Proportion of cases = 0.05537972 
Warning in mean.default(glm_df[glm_df$Y == 0, "PRS"]) :
  argument is not numeric or logical: returning NA
mean PRS for controls = NA 
Warning in mean.default(glm_df[glm_df$Y == 1, "PRS"]) :
  argument is not numeric or logical: returning NA
mean PRS for cases = NA 
[1] "Anova of PRS ~ Y :"
                Df Sum Sq Mean Sq F value Pr(>F)    
Y                1    316   316.5    3142 <2e-16 ***
Residuals   440755  44394     0.1                   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
`summarise()` ungrouping output (override with `.groups` argument)
null device 
          1 

==Computing and testing total PRS for test dataset from the following files ==
 [1] "../output/test_prs_chr1.txt"  "../output/test_prs_chr10.txt"
 [3] "../output/test_prs_chr11.txt" "../output/test_prs_chr12.txt"
 [5] "../output/test_prs_chr13.txt" "../output/test_prs_chr14.txt"
 [7] "../output/test_prs_chr15.txt" "../output/test_prs_chr16.txt"
 [9] "../output/test_prs_chr17.txt" "../output/test_prs_chr18.txt"
[11] "../output/test_prs_chr19.txt" "../output/test_prs_chr2.txt" 
[13] "../output/test_prs_chr20.txt" "../output/test_prs_chr21.txt"
[15] "../output/test_prs_chr22.txt" "../output/test_prs_chr3.txt" 
[17] "../output/test_prs_chr4.txt"  "../output/test_prs_chr5.txt" 
[19] "../output/test_prs_chr6.txt"  "../output/test_prs_chr7.txt" 
[21] "../output/test_prs_chr8.txt"  "../output/test_prs_chr9.txt" 
PRS dataframe for test dataset:
'data.frame':	4201 obs. of  48 variables:
 $ Sample_ID     : chr  "SM-IXVUB" "SM-IXVUC" "SM-IXVUD" "SM-IXVUE" ...
 $ epr_number    : num  100663 100797 100926 101095 101207 ...
 $ Y             : Factor w/ 2 levels "0","1": 2 1 1 1 1 1 1 1 1 1 ...
 $ PC1           : num  0.00698 0.00544 0.00686 0.0069 0.00686 ...
 $ PC2           : num  -0.00327 0.000316 -0.003605 -0.003672 -0.003354 ...
 $ PC3           : num  -0.001008 0.000535 -0.002062 -0.001739 -0.001598 ...
 $ PC4           : num  -3.42e-05 2.95e-04 3.85e-05 2.40e-04 -3.67e-06 ...
 $ PC5           : num  -0.00517 0.08926 -0.00455 -0.00584 -0.00343 ...
 $ PC6           : num  -1.71e-04 -1.36e-04 1.61e-04 2.06e-04 7.81e-05 ...
 $ PC7           : num  -0.000367 0.047886 -0.000227 0.000139 -0.000398 ...
 $ PC8           : num  5.04e-05 -2.92e-03 1.77e-04 -2.35e-04 -4.15e-04 ...
 $ PC9           : num  0.000137 0.004464 -0.000119 0.000473 -0.000207 ...
 $ PC10          : num  1.83e-04 2.69e-03 -2.45e-04 -1.79e-05 -1.65e-04 ...
 $ PC11          : num  1.37e-04 9.42e-04 -1.13e-04 -2.89e-04 2.30e-06 ...
 $ PC12          : num  3.13e-04 -1.62e-04 -5.16e-05 -1.58e-04 8.81e-05 ...
 $ PC13          : num  1.54e-04 3.41e-04 -2.39e-04 3.27e-05 -1.12e-04 ...
 $ PC14          : num  1.15e-04 6.44e-05 3.39e-04 9.73e-05 2.45e-04 ...
 $ PC15          : num  -1.57e-04 -2.95e-04 -1.39e-04 2.43e-04 -9.81e-05 ...
 $ PC16          : num  -4.56e-05 -5.78e-04 3.74e-05 5.24e-04 -7.38e-05 ...
 $ PC17          : num  -2.50e-04 -2.16e-04 -1.52e-04 -9.97e-05 1.88e-04 ...
 $ PC18          : num  -1.66e-04 1.23e-04 -1.04e-04 2.54e-05 1.39e-04 ...
 $ PC19          : num  -6.05e-05 1.99e-04 -3.85e-04 -3.40e-05 1.27e-04 ...
 $ PC20          : num  -1.59e-05 -4.60e-04 -1.61e-04 -2.60e-04 -2.37e-04 ...
 $ PC21          : num  0.000144 0.000866 0.000116 0.000274 0.000116 ...
 $ PC22          : num  -2.03e-04 -6.01e-04 -7.86e-05 2.18e-05 1.52e-05 ...
 $ PC23          : num  -4.73e-04 -7.73e-04 -5.12e-05 -2.32e-04 -7.41e-05 ...
 $ PC24          : num  7.58e-05 3.76e-04 2.84e-04 1.29e-05 1.23e-04 ...
 $ PC25          : num  0.000133 0.000757 0.000276 -0.000212 -0.000218 ...
 $ PC26          : num  -5.43e-05 3.16e-04 2.39e-04 4.03e-04 2.64e-04 ...
 $ PC27          : num  -1.54e-05 3.87e-04 9.09e-05 5.19e-04 -1.61e-04 ...
 $ PC28          : num  -1.64e-04 2.80e-04 -1.28e-05 -3.07e-04 2.59e-04 ...
 $ PC29          : num  -2.51e-04 5.97e-04 -1.47e-04 3.27e-05 5.21e-05 ...
 $ PC30          : num  2.53e-04 -1.08e-03 -2.65e-05 1.05e-04 -1.61e-04 ...
 $ PC31          : num  -1.48e-04 -8.21e-04 7.87e-05 2.39e-04 -7.76e-05 ...
 $ PC32          : num  0.00041 0.000512 0.000235 0.000271 0.00012 ...
 $ PC33          : num  -0.000101 -0.00065 0.000182 0.00015 0.000174 ...
 $ PC34          : num  2.13e-05 -1.43e-04 -1.47e-05 -5.26e-04 7.28e-05 ...
 $ PC35          : num  -3.28e-05 -8.88e-04 6.49e-05 3.21e-04 -2.95e-05 ...
 $ PC36          : num  2.24e-04 -1.48e-03 -1.59e-04 -2.41e-04 5.28e-05 ...
 $ PC37          : num  -2.23e-05 6.40e-04 1.62e-04 2.10e-04 2.58e-05 ...
 $ PC38          : num  4.52e-05 3.44e-04 1.80e-05 -4.94e-04 -1.22e-05 ...
 $ PC39          : num  6.10e-05 4.29e-04 1.29e-05 -6.49e-05 -3.06e-05 ...
 $ PC40          : num  1.75e-04 -1.53e-04 -3.03e-04 2.95e-05 -1.45e-04 ...
 $ age_derived   : num  81 72 69 52 59 32 82 74 76 74 ...
 $ gender        : Factor w/ 2 levels "0","1": 2 2 2 1 1 1 1 2 2 2 ...
 $ race          : Factor w/ 6 levels "1","2","3","4",..: 5 5 5 5 5 5 5 5 5 5 ...
 $ he_bmi_derived: num  33 27.3 23.4 32.9 35.2 22 27.3 21 33.2 26.6 ...
 $ PRS           : num  0.358 0.871 0.503 0.511 0.46 ...
[1] "In function do_glm() :"
[1] "data frame for glm model:"
'data.frame':	4201 obs. of  15 variables:
 $ Y             : Factor w/ 2 levels "0","1": 2 1 1 1 1 1 1 1 1 1 ...
 $ PC1           : num  0.00698 0.00544 0.00686 0.0069 0.00686 ...
 $ PC2           : num  -0.00327 0.000316 -0.003605 -0.003672 -0.003354 ...
 $ PC3           : num  -0.001008 0.000535 -0.002062 -0.001739 -0.001598 ...
 $ PC4           : num  -3.42e-05 2.95e-04 3.85e-05 2.40e-04 -3.67e-06 ...
 $ PC5           : num  -0.00517 0.08926 -0.00455 -0.00584 -0.00343 ...
 $ PC6           : num  -1.71e-04 -1.36e-04 1.61e-04 2.06e-04 7.81e-05 ...
 $ PC7           : num  -0.000367 0.047886 -0.000227 0.000139 -0.000398 ...
 $ PC8           : num  5.04e-05 -2.92e-03 1.77e-04 -2.35e-04 -4.15e-04 ...
 $ PC9           : num  0.000137 0.004464 -0.000119 0.000473 -0.000207 ...
 $ PC10          : num  1.83e-04 2.69e-03 -2.45e-04 -1.79e-05 -1.65e-04 ...
 $ age_derived   : num  81 72 69 52 59 32 82 74 76 74 ...
 $ gender        : Factor w/ 2 levels "0","1": 2 2 2 1 1 1 1 2 2 2 ...
 $ he_bmi_derived: num  33 27.3 23.4 32.9 35.2 22 27.3 21 33.2 26.6 ...
 $ PRS           : num  0.358 0.871 0.503 0.511 0.46 ...
NULL
[1] "Fitting GLM model:"
Y ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 + PC10 + 
    age_derived + gender + he_bmi_derived + PRS
<environment: 0x69aa6770>
[1] "GLM model summary:"

Call:
glm(formula = glm_formula, family = "binomial", data = glm_df, 
    singular.ok = FALSE)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1517  -0.4418  -0.2633  -0.1356   3.3258  

Coefficients:
                 Estimate Std. Error z value Pr(>|z|)    
(Intercept)    -10.488513   0.492296 -21.305  < 2e-16 ***
PC1            -15.390425   4.157454  -3.702 0.000214 ***
PC2              3.783891   5.159913   0.733 0.463361    
PC3             -0.155508   6.236249  -0.025 0.980106    
PC4             -7.994819  22.637235  -0.353 0.723960    
PC5             -7.404151   4.685435  -1.580 0.114050    
PC6            -15.448832  17.183591  -0.899 0.368628    
PC7             -8.062031   4.162068  -1.937 0.052742 .  
PC8             13.320915   9.144751   1.457 0.145207    
PC9             10.413251   4.949070   2.104 0.035371 *  
PC10            -1.722378   3.079917  -0.559 0.576006    
age_derived      0.070494   0.005017  14.052  < 2e-16 ***
gender1         -0.371075   0.122333  -3.033 0.002419 ** 
he_bmi_derived   0.122103   0.008211  14.870  < 2e-16 ***
PRS              1.075873   0.197173   5.456 4.86e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2619.3  on 4200  degrees of freedom
Residual deviance: 2055.3  on 4186  degrees of freedom
AIC: 2085.3

Number of Fisher Scoring iterations: 7

Setting levels: control = 0, case = 1
Setting direction: controls < cases
GLM output for test dataset:
  estimate std_error   zvalue       pvalue       auc
1 1.075873 0.1971729 5.456498 4.856156e-08 0.8414303
[1] "Calculating pseudo-R2:"
[1] "Full model (with PRS):"
Logistic Regression Model
 
 lrm(formula = Y ~ ., data = glm_df)
 
                        Model Likelihood    Discrimination    Rank Discrim.    
                              Ratio Test           Indexes          Indexes    
 Obs          4201    LR chi2     564.04    R2       0.271    C       0.841    
  0           3806    d.f.            14    g        1.706    Dxy     0.683    
  1            395    Pr(> chi2) <0.0001    gr       5.510    gamma   0.683    
 max |deriv| 2e-05                          gp       0.111    tau-a   0.116    
                                            Brier    0.073                     
 
                Coef     S.E.    Wald Z Pr(>|Z|)
 Intercept      -10.4885  0.4923 -21.31 <0.0001 
 PC1            -15.3904  4.1584  -3.70 0.0002  
 PC2              3.7839  5.1599   0.73 0.4634  
 PC3             -0.1555  6.2363  -0.02 0.9801  
 PC4             -7.9948 22.6702  -0.35 0.7243  
 PC5             -7.4042  4.6854  -1.58 0.1141  
 PC6            -15.4488 17.1836  -0.90 0.3686  
 PC7             -8.0620  4.1621  -1.94 0.0527  
 PC8             13.3209  9.1448   1.46 0.1452  
 PC9             10.4133  4.9491   2.10 0.0354  
 PC10            -1.7224  3.0799  -0.56 0.5760  
 age_derived      0.0705  0.0050  14.05 <0.0001 
 gender=1        -0.3711  0.1223  -3.03 0.0024  
 he_bmi_derived   0.1221  0.0082  14.87 <0.0001 
 PRS              1.0759  0.1972   5.46 <0.0001 
 
[1] "Reduced model (without PRS):"
Logistic Regression Model
 
 lrm(formula = Y ~ ., data = glm_df %>% select(-PRS))
 
                        Model Likelihood    Discrimination    Rank Discrim.    
                              Ratio Test           Indexes          Indexes    
 Obs          4201    LR chi2     533.86    R2       0.257    C       0.832    
  0           3806    d.f.            13    g        1.624    Dxy     0.664    
  1            395    Pr(> chi2) <0.0001    gr       5.076    gamma   0.664    
 max |deriv| 9e-05                          gp       0.108    tau-a   0.113    
                                            Brier    0.073                     
 
                Coef     S.E.    Wald Z Pr(>|Z|)
 Intercept       -9.9873  0.4727 -21.13 <0.0001 
 PC1            -22.3271  3.8780  -5.76 <0.0001 
 PC2              6.2317  5.1012   1.22 0.2219  
 PC3              0.7250  6.1204   0.12 0.9057  
 PC4             -6.7715 19.7365  -0.34 0.7315  
 PC5             -2.7384  4.5587  -0.60 0.5480  
 PC6            -14.4317 16.9163  -0.85 0.3936  
 PC7             -7.2049  4.1023  -1.76 0.0790  
 PC8             11.7692  8.8923   1.32 0.1857  
 PC9              9.5550  4.8011   1.99 0.0466  
 PC10            -0.3966  3.0412  -0.13 0.8962  
 age_derived      0.0695  0.0050  14.03 <0.0001 
 gender=1        -0.3675  0.1214  -3.03 0.0025  
 he_bmi_derived   0.1189  0.0081  14.74 <0.0001 
 
Proportion of variance explained by PRS using Nagelkerke’s pseudo-R2 metric = 0.01358861 
Proportion of cases = 0.09402523 
mean PRS for controls = 0.2620312 
mean PRS for cases = 0.3746193 
[1] "Anova of PRS ~ Y :"
              Df Sum Sq Mean Sq F value   Pr(>F)    
Y              1    4.5   4.536   41.95 1.04e-10 ***
Residuals   4199  454.1   0.108                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
`summarise()` ungrouping output (override with `.groups` argument)
null device 
          1 
